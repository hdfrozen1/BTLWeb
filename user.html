<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Th√¥ng tin ng∆∞·ªùi d√πng</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      background-color: #eef2f7;
      margin: 0;
      padding: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    /* Thanh ti√™u ƒë·ªÅ */
    .header {
      width: 100%;
      background-color: #2d6cdf;
      color: white;
      text-align: center;
      padding: 20px 0;
      font-size: 24px;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    }

    .container {
      background-color: white;
      border-radius: 12px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      width: 420px;
      margin-top: 60px;
      padding: 30px 40px;
    }

    h2 {
      color: #2d6cdf;
      text-align: center;
      margin-bottom: 25px;
    }

    label {
      display: block;
      font-weight: bold;
      margin-top: 10px;
      margin-bottom: 5px;
      color: #333;
    }

    input {
      width: 100%;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 6px;
      margin-bottom: 15px;
      background-color: #f9f9f9;
      color: #333;
    }

    input:disabled {
      background-color: #f0f0f0;
      color: #555;
    }

    button {
      width: 100%;
      padding: 10px;
      background-color: #2d6cdf;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 1em;
      cursor: pointer;
      transition: 0.2s;
    }

    button:hover {
      background-color: #184fb8;
    }

    small {
      color: #666;
      font-size: 0.85em;
    }

  </style>
</head>
<body>

  <div class="header">
    <h1>ƒêƒÇNG K√ù XE M√ÅY TR·ª∞C TUY·∫æN</h1>
  </div>

  <div class="container">
    <h2>Th√¥ng tin ng∆∞·ªùi d√πng</h2>

    <label for="cmnd">S·ªë CMND:</label>
    <input type="text" id="cmnd" disabled>

    <label for="name">H·ªç v√† t√™n:</label>
    <input type="text" id="name" disabled>

    <label for="dob">Ng√†y sinh:</label>
    <input type="text" id="dob" disabled>

    <label for="address">Qu√™ qu√°n:</label>
    <input type="text" id="address" disabled>

    <label for="email">ƒê·ªãa ch·ªâ Email:</label>
    <input type="email" id="email" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ email c·ªßa b·∫°n" required>

    <label for="phone">S·ªë ƒëi·ªán tho·∫°i:</label>
    <input type="tel" id="phone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i c·ªßa b·∫°n" required>

    <label for="imageUpload">·∫¢nh c√° nh√¢n (b·∫Øt bu·ªôc, d∆∞·ªõi 2MB):</label>
    <input type="file" id="imageUpload" accept="image/*">
    <small>Ch·ªâ ch·∫•p nh·∫≠n t·ªáp ·∫£nh d∆∞·ªõi 2MB</small>

    <button id="registerBtn">ƒêƒÉng k√Ω xe m√°y</button>
    <button onclick="logout()">ƒêƒÉng xu·∫•t</button>
  </div>

  <script>
    // L·∫•y th√¥ng tin ng∆∞·ªùi d√πng hi·ªán t·∫°i t·ª´ localStorage
    let currentUser = JSON.parse(localStorage.getItem("currentUser"));

    if (!currentUser) {
      alert("B·∫°n ch∆∞a ƒëƒÉng nh·∫≠p!");
      window.location.href = "index.html";
    } else {
      document.getElementById("cmnd").value = currentUser.cmnd || "";
      document.getElementById("name").value = currentUser.ten || "";
      document.getElementById("dob").value = currentUser.ngaysinh || "";
      document.getElementById("address").value = currentUser.quequan || "";
    }

    document.getElementById("registerBtn").addEventListener("click", () => {
  if (currentUser.phanhoi === 1) {
    alert("H·ªì s∆° c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒëi v√† ƒëang ƒë∆∞·ª£c x√©t duy·ªát. Vui l√≤ng ch·ªù ph·∫£n h·ªìi qua email.");
    return;
  }

  const email = document.getElementById("email").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const fileInput = document.getElementById("imageUpload");
  const file = fileInput.files[0];

  if (!email || !phone) {
    alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß email v√† s·ªë ƒëi·ªán tho·∫°i!");
    return;
  }

  if (!file) {
    alert("Vui l√≤ng t·∫£i l√™n ·∫£nh c√° nh√¢n!");
    return;
  }

  if (file.size > 2 * 1024 * 1024) {
    alert("K√≠ch th∆∞·ªõc ·∫£nh v∆∞·ª£t qu√° 2MB!");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(e) {
    const imageBase64 = e.target.result;

    // C·∫≠p nh·∫≠t th√¥ng tin ng∆∞·ªùi d√πng
    currentUser.email = email;
    currentUser.sodienthoai = phone;
    currentUser.imageBase64 = imageBase64; // üü© L∆∞u ·∫£nh base64
    currentUser.phanhoi = 1;

    // L∆∞u v√†o localStorage
    localStorage.setItem("currentUser", JSON.stringify(currentUser));

    const allUsers = JSON.parse(localStorage.getItem("users")) || [];
    const index = allUsers.findIndex(u => u.id === currentUser.id);
    if (index !== -1) {
      allUsers[index] = currentUser;
      localStorage.setItem("users", JSON.stringify(allUsers));
    }

    alert("H·ªì s∆° c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i ƒëi v√† ƒëang ƒë∆∞·ª£c x√©t duy·ªát. Vui l√≤ng ch·ªù ph·∫£n h·ªìi qua email.");
  };

  reader.readAsDataURL(file);
});

    function logout() {
      localStorage.removeItem("currentUser");
      window.location.href = "index.html";
    }
  </script>

</body>
</html>
